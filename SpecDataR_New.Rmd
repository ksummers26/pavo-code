---
title: "PAVO Analysis"
output: html_notebook
author: Emily White
---

```{r}
#install.packages("pavo")
```

```{r}
library("pavo")
```

Step 1: Organization and Processing
```{r}
#create a data frame that includes frog IDs and path to directory with spec data

frog_dirs <- dir(file.path("C:/Users/emmid/Desktop/SpecData/"), recursive=TRUE, include.dirs=TRUE, pattern= "(^\\d*$)|(^..\\d$)")

spec_dirs<- file.path("C:/Users/emmid/Desktop/SpecData", frog_dirs)

frog_IDs <- read.table(file.path("C:/Users/emmid/Desktop/SpecData/Frog_IDs.txt"), header = TRUE, stringsAsFactors=FALSE)

spec_dirs_IDs <- dplyr::mutate(frog_IDs, path = spec_dirs)
spec_dirs_IDs
```

```{r}
#create a function to analyze spec data for each frog

spec_analysis <- function(row) 
{
  #import/visualize spectral data
  specs <- getspec(where=spec_dirs_IDs[row,2], ext='txt', lim=c(346,1041), subdir=TRUE, subdir.names=TRUE)
  explorespec(specs, by=1, ylim=range(0,40))
  
  #subset spec data for body region
  #combine spec data within region and take the average
  #apply LOESS smoothing, make neg values 0
  #plot spectral curve
  
  specs_dorsum <- subset(specs, subset= c("a", "b", "c", "d", "e", "f", "p", "q"))
  dorsum_agg <- aggspec(specs_dorsum, by=8, FUN="mean")
  dorsum_agg_smooth <- procspec(dorsum_agg, opt="smooth", fixneg="zero", span=0.15)
  explorespec(dorsum_agg_smooth, by=1, ylim=range(0,40))
  
  specs_hindlegs <- subset(specs, subset= c("g","h"))
  hindlegs_agg <- aggspec(specs_hindlegs, by=2, FUN="mean")
  hindlegs_agg_smooth <- procspec(hindlegs_agg, opt="smooth", fixneg="zero", span=0.15)
  explorespec(hindlegs_agg_smooth, by=1, ylim=range(0,40))
  
  specs_forelimbs <- subset(specs, subset= c("n", "o"))
  forelimbs_agg <- aggspec(specs_forelimbs, by=2, FUN="mean")
  forelimbs_agg_smooth <- procspec(forelimbs_agg, opt="smooth", fixneg="zero", span=0.15)
  explorespec(forelimbs_agg_smooth, by=1, ylim=range(0,40))
  
  #calculate colorimetric variables for each region (Montgomerie 2006)
    dorsum_summary <- summary(dorsum_agg_smooth)
    hindlegs_summary <- summary(hindlegs_agg_smooth)
    forelimbs_summary <- summary(forelimbs_agg_smooth)
  
  #combine summary variables for each region into one data frame
    summary_frog <- rbind(dorsum_summary, hindlegs_summary, forelimbs_summary)
    return(summary_frog)
}
```

```{r}
#print frog ID
spec_dirs_IDs[1,1]
#run spec analysis
spec_analysis(1)
```


```{r}
#function that prints frog ID and runs spec analysis for a specified individual

do <- function(y) 
{print(spec_dirs_IDs[y,1])
  spec_analysis(y)}

#for (y in c(1:62)) do(y)
```


```{r}
do(1)
```

```{r}
do(2)
```

```{r}
do(3)
```

```{r}
do(4)
```

```{r}
do(5)
```

6 has 10 spectra files
```{r}
#do(6)
```

```{r}
do(7)
```

```{r}
do(8)
```

```{r}
do(9)
```

```{r}
do(10)
```

```{r}
do(11)
```

```{r}
do(12)
```

```{r}
do(13)
```

```{r}
do(14)
```

```{r}
do(15)
```

```{r}
do(16)
```

```{r}
do(17)
```

```{r}
#do(18)
```

```{r}
do(19)
```

```{r}
do(20)
```

```{r}
do(21)
```

```{r}
do(22)
```

```{r}
do(23)
```

```{r}
do(24)
```

```{r}
do(25)
```

```{r}
do(26)
```

```{r}
do(27)
```

```{r}
do(28)
```

```{r}
do(29)
```

```{r}
do(30)
```

```{r}
do(31)
```

```{r}
do(32)
```

```{r}
do(33)
```

```{r}
do(34)
```

```{r}
do(35)
```

```{r}
do(36)
```

```{r}
do(37)
```

```{r}
do(38)
```

```{r}
do(39)
```

```{r}
#do(40)
```

41 only had 10 spectra files
```{r}
#do(41)
```

42 only had 8 spectra files
```{r}
#do(42)
```

```{r}
#do(43)
```

```{r}
#do(44)
```

```{r}
#do(45)
```

```{r}
#do(46)
```

```{r}
#do(47)
```

```{r}
#do(48)
```

```{r}
#do(49)
```

```{r}
#do(50)
```

```{r}
#do(51)
```

```{r}
#do(52)
```

```{r}
#do(53)
```

```{r}
#do(54)
```

```{r}
#do(55)
```

```{r}
#do(56)
```

```{r}
#do(57)
```

```{r}
#do(58)
```

```{r}
do(59)
```

```{r}
do(60)
```

```{r}
do(61)
```

```{r}
do(62)
```

